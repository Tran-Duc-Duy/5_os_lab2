# Лабораторная работа #2

debugfs: dstat

***

### Текст задания:

Разработать комплекс программ на пользовательском уровне и уровне ярда, который собирает информацию на стороне ядра и
передает информацию на уровень пользователя, и выводит ее в удобном для чтения человеком виде. Программа на уровне
пользователя получает на вход аргумент(ы) командной строки (не адрес!), позволяющие идентифицировать из системных таблиц
необходимый путь до целевой структуры, осуществляет передачу на уровень ядра, получает информацию из данной структуры и
распечатывает структуру в стандартный вывод. Загружаемый модуль ядра принимает запрос через указанный в задании
интерфейс, определяет путь до целевой структуры по переданному запросу и возвращает результат на уровень пользователя.

### Выполнение:

Был разработан модуль ядра линукса на `Clang`, который собирает информацию как команда dstat и выводит ее
в `/sys/kernel/debug/dstat/info`.
Так же на `Python` была реализована программа на пользовательском уровне, которая выводит информация в читаемом виде,
реализовано два способа поучения информации в виде `классического` вывода dstat и `json`. Также можно указывать
интервал, с которым выводить данные, это удобно для профилирования.

**[Код программы на уровне ядра](./module/mydstat.c)** \
**[Код программы на уровне пользователя](./main.y)**

Загрузка модуля в ядро:

```text
make build
sudo insmod mydstat.ko
make clean
```

Запуск программы на уровне пользователя:

```text
pyinstaller --onefile main.py  
./main --json --I 1
```

***

### Вывод:

Я познакомился с исходным кодом ядра его структурами, а также научился писать свои загружаемые модули и использовать
интерфейс
debugfs для передачи данных. Уверен, полученная информация пригодится мне в будущем.


---
Phan tich de bai:   

    /proc/stat: Để lấy thông tin về tổng CPU sử dụng, bạn cần đọc dòng bắt đầu bằng "cpu " (chữ "cpu" theo sau là một khoảng trắng).
    /proc/diskstats: Để lấy thông tin về tốc độ đọc/ghi đĩa, bạn cần đọc dòng tương ứng với ổ đĩa bạn quan tâm (ví dụ: "sda", "sdb",...).
    /proc/net/dev: Để lấy thông tin về tốc độ nhận/gửi dữ liệu qua mạng, bạn cần đọc dòng tương ứng với giao diện mạng bạn muốn xem (ví dụ: "eth0", "wlan0",...).
    /proc/vmstat: Để lấy thông tin về trang (paging), bạn có thể tìm các dòng chứa thông tin như "pgpgin", "pgpgout", "pswpin", "pswpout".
    /proc/stat: Để lấy thông tin về thông tin hệ thống, bạn có thể tìm các dòng chứa thông tin như "intr", "ctxt".
